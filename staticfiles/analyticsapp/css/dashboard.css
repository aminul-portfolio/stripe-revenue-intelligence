/* =========================================
   ANALYTICS DASHBOARD (REFERENCE LOOK)
   File: analyticsapp/static/analyticsapp/css/dashboard.css
   Notes:
   - KPI tiles keep blobs contained (overflow:hidden)
   - KPI clipping fixed via right padding + tuned font clamp
   - No duplicate .kpi/.kpi-value blocks (canonical)
   ========================================= */
/* FINGERPRINT: dashboard.css loaded */
body::before{
  content:"dashboard.css LOADED âœ…";
  position:fixed;
  left:12px;
  bottom:12px;
  z-index:99999;
  background:#111;
  color:#fff;
  padding:6px 10px;
  border-radius:10px;
  font:700 12px system-ui;
}

/* Shell + header */
.dash-shell{
  background:var(--dash-surface);
  border:1px solid var(--dash-border);
  border-radius:28px;
  box-shadow:var(--dash-shadow);
  padding:26px;
}

.dash-head{
  display:flex;
  align-items:flex-start;
  justify-content:space-between;
  gap:18px;
  margin-bottom:18px;
}

.dash-title{min-width:320px}
.dash-h1{
  margin:0;
  font-size:54px;
  line-height:1.05;
  letter-spacing:-.6px;
}
.dash-sub{
  margin-top:10px;
  color:rgba(15,23,42,.75);
  font-size:18px;
}

.dash-actions{
  display:flex;
  gap:12px;
  align-items:center;
  flex-wrap:wrap;
  padding-top:4px;
}

/* Tabs (pill) */
.tabs{
  display:flex;
  border-radius:999px;
  overflow:hidden;
  border:1px solid rgba(15,23,42,.12);
  background:rgba(255,255,255,.75);
}

.tab{
  padding:12px 18px;
  font-weight:800;
  letter-spacing:.2px;
  color:rgba(15,23,42,.78);
  border-right:1px solid rgba(15,23,42,.10);
}
.tab:last-child{border-right:0}
.tab:hover{background:rgba(15,23,42,.04)}
.tab.active{
  background:#0b4ea2;
  color:#fff;
}

/* Exports menu (no JS; <details>) */
.menu{position:relative}
.menu-btn{
  list-style:none;
  cursor:pointer;
  padding:12px 18px;
  border-radius:999px;
  border:1px solid rgba(15,23,42,.12);
  background:rgba(255,255,255,.75);
  font-weight:800;
  user-select:none;
}
.menu summary::-webkit-details-marker{display:none}
.menu[open] .menu-btn{box-shadow:0 10px 24px rgba(15,23,42,.14)}
.menu-pop{
  position:absolute;
  right:0;
  top:56px;
  min-width:240px;
  background:#fff;
  border:1px solid rgba(15,23,42,.12);
  border-radius:16px;
  box-shadow:0 18px 45px rgba(15,23,42,.18);
  padding:10px;
  z-index:60;
}
.menu-pop a{
  display:block;
  padding:12px 12px;
  border-radius:12px;
  font-weight:700;
}
.menu-pop a:hover{background:rgba(15,23,42,.05)}
.caret{margin-left:6px}

/* KPI grid */
.kpi-grid{
  display:grid;
  gap:14px;
  margin-top:10px;
  margin-bottom:18px;
}

.kpi-grid--5{grid-template-columns:repeat(5,minmax(0,1fr))}
@media(max-width:1280px){.kpi-grid--5{grid-template-columns:repeat(4,minmax(0,1fr))}}
@media(max-width:1200px){.kpi-grid--5{grid-template-columns:repeat(3,minmax(0,1fr))}}
@media(max-width:760px){.kpi-grid--5{grid-template-columns:repeat(1,minmax(0,1fr))}}

/* IMPORTANT: prevents grid min-width squeeze that can clip text */
.kpi-grid > *{min-width:0}

/* KPI tile */
.kpi{
  position:relative;
  border-radius:22px;

  /* Key fix: extra right padding prevents currency clipping */
  padding:16px 22px 14px 16px;

  color:#fff;
  overflow:hidden; /* keeps blobs inside */
  box-shadow:0 18px 40px rgba(15,23,42,.18);
  border:1px solid rgba(255,255,255,.14);
  min-width:0;
}

/* Blob overlays (behind text) */
.kpi::before{
  content:"";
  position:absolute;
  right:-40px;
  top:-40px;
  width:160px;
  height:160px;
  border-radius:999px;
  background:rgba(255,255,255,.14);
  z-index:0;
}
.kpi::after{
  content:"";
  position:absolute;
  right:-10px;
  bottom:-60px;
  width:220px;
  height:220px;
  border-radius:999px;
  background:rgba(255,255,255,.10);
  z-index:0;
}
.kpi > *{position:relative;z-index:2}

/* KPI typography */
.kpi-label{
  color:rgba(255,255,255,.92);
  font-size:14px;
  font-weight:800;
  letter-spacing:.2px;
  text-shadow:0 1px 0 rgba(0,0,0,.08);
}

.kpi-value{
  margin-top:10px;
  font-weight:950;
  letter-spacing:-0.04em;
  line-height:.96;

  /* Tuned to fit 5-column desktop without clipping */
  font-size:clamp(30px, 2.7vw, 54px);

  /* Keep currency on one line; do NOT self-clip */
  white-space:nowrap;
  overflow:visible;
  text-overflow:clip;
  max-width:100%;

  font-variant-numeric:tabular-nums;
}

/* Stronger safety for desktop 5-col */
@media (min-width:1100px){
  .kpi-grid--5 .kpi-value{
    font-size:clamp(30px, 2.2vw, 50px);
  }
}

.kpi-meta{
  margin-top:12px;
  font-size:14px;
  color:rgba(255,255,255,.90);
  text-shadow:0 1px 0 rgba(0,0,0,.08);
}

/* KPI tones */
.tone-blue{background:linear-gradient(135deg,var(--blue),var(--blue2))}
.tone-green{background:linear-gradient(135deg,var(--green),var(--green2))}
.tone-purple{background:linear-gradient(135deg,var(--purple),var(--purple2))}
.tone-red{background:linear-gradient(135deg,var(--red),var(--red2))}
.tone-dark{background:linear-gradient(135deg,var(--dark),var(--dark2))}

/* Panels grid (charts layout) */
.panel-grid{
  display:grid;
  gap:14px;
  margin-top:14px;
}
.panel-grid--3{grid-template-columns:repeat(3,minmax(0,1fr))}
.panel-grid--4{grid-template-columns:repeat(4,minmax(0,1fr))}

@media(max-width:1200px){.panel-grid--4{grid-template-columns:repeat(2,minmax(0,1fr))}}
@media(max-width:980px){
  .panel-grid--3{grid-template-columns:1fr}
  .panel-grid--4{grid-template-columns:1fr}
}

/* Plot sizing (prevents blank tall panels) */
.plot{
  width:100%;
  height:320px;
}
.plot--tall{
  height:360px;
}
